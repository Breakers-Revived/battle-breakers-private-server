var loginFormDiv=document.querySelector(".login-form"),signupFormDiv=document.querySelector(".signup-form"),onboardingFormDiv=document.querySelector(".onboarding-form"),signupLink=document.querySelector(".signup-link"),loginLink=document.querySelector(".login-link"),loginForm=document.querySelector("#login-form"),loginUsername=document.querySelector("#login-name"),loginPassword=document.querySelector("#login-password"),signupForm=document.querySelector("#signup-form"),signupUsername=document.querySelector("#signup-username"),signupPassword=document.querySelector("#signup-password"),signupConfirmPassword=document.querySelector("#signup-confirm-password"),loginButton=document.querySelector("#login-button"),signupButton=document.querySelector("#signup-button"),onboardingButton=document.querySelector("#onboarding-button"),loginSpinner=document.querySelector("#login-spinner"),signupSpinner=document.querySelector("#signup-spinner");function handleSignupClick(e){"use strict";e.preventDefault?e.preventDefault():e.returnValue=!1,loginFormDiv.style.display="none",signupFormDiv.style.display="block"}function handleLoginClick(e){"use strict";e.preventDefault?e.preventDefault():e.returnValue=!1,signupFormDiv.style.display="none",loginFormDiv.style.display="block"}function removeListeners(){"use strict";signupLink.removeEventListener("click",handleSignupClick),loginLink.removeEventListener("click",handleLoginClick)}function addListeners(){"use strict";signupLink.addEventListener("click",handleSignupClick),loginLink.addEventListener("click",handleLoginClick)}loginFormDiv.style.display="block",signupFormDiv.style.display="none",onboardingFormDiv.style.display="none",document.querySelector(".javascript-warning").style.display="none",signupLink.addEventListener("click",handleSignupClick),loginLink.addEventListener("click",handleLoginClick);var showOnboarding=function e(n,s,i,r){return signupFormDiv.style.display="none",loginFormDiv.style.display="none",onboardingFormDiv.style.display="block",document.querySelector("#welcome").innerText="Welcome, "+n,document.querySelector("#id").innerText=i,document.querySelector("#onboarding-heading").innerText=r,onboardingButton.addEventListener("click",function(){event.preventDefault?event.preventDefault():event.returnValue=!1,window.location.href="com.epicgames.wex://authorize/?code="+s}),!0};signupForm.addEventListener("submit",function(e){"use strict";var n;e.preventDefault?e.preventDefault():e.returnValue=!1,signupSpinner.classList.add("show"),signupButton.disabled=!0,signupUsername.disabled=!0,signupPassword.disabled=!0,signupConfirmPassword.disabled=!0,removeListeners(),setTimeout(function(){if(signupPassword.value!==signupConfirmPassword.value)signupSpinner.classList.remove("show"),window.alert("Passwords do not match!"),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners();else if(signupPassword.value.length<4)signupSpinner.classList.remove("show"),window.alert("Password must be at least 4 characters long!"),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners();else if(signupPassword.value.length>64)signupSpinner.classList.remove("show"),window.alert("Password must be less than 64 characters long!"),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners();else if(signupUsername.value.length<3)signupSpinner.classList.remove("show"),window.alert("Username must be at least 3 characters long!"),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners();else if(signupUsername.value.length>24)signupSpinner.classList.remove("show"),window.alert("Username must be less than 24 characters long!"),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners();else if(signupPassword.value===signupUsername.value)signupSpinner.classList.remove("show"),window.alert("Password cannot be the same as your username!"),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners();else{var e={username:document.querySelector("#signup-username").value,password:document.querySelector("#signup-password").value},s=new window.AbortController,i=s.signal;n=setTimeout(function(){clearTimeout(n),s.abort(),signupSpinner.classList.remove("show"),setTimeout(function(){window.alert("Request timed out. Please try again later.")},1),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners()},1e4),fetch("/id/login/token",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"basic ZWMwZWJiN2U1NmY2NDU0ZTg2YzYyMjk5YTdiMzJlMjE6YmJwcml2YXRlc2VydmVyaW5tZW1vcnlvZmRpcHB5PDM=","X-Requested-With":"XMLHttpRequest","X-Request-Source":"login-script.js","X-Request-Source-Url":window.location.href,"X-Request-Source-Form":"signup-form"},body:JSON.stringify(e),signal:i}).then(function(n){200===n.status?n.json().then(function(n){signupSpinner.classList.remove("show"),showOnboarding(e.username,n.authorisationCode,n.id,n.heading)}).catch(function(){signupSpinner.classList.remove("show"),window.alert("An error occurred when trying to log in!\n\nSomething went wrong when redirecting... Please try again later."),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners()}):n.json().then(function(e){signupSpinner.classList.remove("show"),window.alert("An error occurred when logging in!\n\n"+e.errorMessage),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners()}).catch(function(){signupSpinner.classList.remove("show"),window.alert("An error occurred when trying to login!\n\nError Info:\n"+n.status+" "+n.statusText+"\n"+n.body.toString()),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners()})}).catch(function(e){"AbortError"!==e.name&&(signupSpinner.classList.remove("show"),window.alert("An error occurred when logging in!\n\n"+e),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1,addListeners())}).finally(function(){clearTimeout(n),signupSpinner.classList.remove("show"),signupButton.disabled=!1,signupUsername.disabled=!1,signupPassword.disabled=!1,signupConfirmPassword.disabled=!1})}},1e3)}),loginForm.addEventListener("submit",function(e){"use strict";var n;e.preventDefault?e.preventDefault():e.returnValue=!1,loginSpinner.classList.add("show"),loginButton.disabled=!0,loginUsername.disabled=!0,loginPassword.disabled=!0,removeListeners(),setTimeout(function(){if(loginPassword.value.length<4)loginSpinner.classList.remove("show"),window.alert("Password must be at least 4 characters long!"),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners();else if(loginPassword.value.length>64)loginSpinner.classList.remove("show"),window.alert("Password must be less than 64 characters long!"),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners();else if(loginUsername.value.length<3)loginSpinner.classList.remove("show"),window.alert("Username must be at least 3 characters long!"),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners();else if(loginPassword.value===loginUsername.value)loginSpinner.classList.remove("show"),window.alert("Password cannot be the same as your username!"),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners();else{var e={username:document.querySelector("#login-name").value,password:document.querySelector("#login-password").value},s=new window.AbortController,i=s.signal;n=setTimeout(function(){clearTimeout(n),s.abort(),loginSpinner.classList.remove("show"),setTimeout(function(){window.alert("Request timed out. Please try again later.")},1),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners()},1e4),fetch("/id/login/token",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"basic ZWMwZWJiN2U1NmY2NDU0ZTg2YzYyMjk5YTdiMzJlMjE6YmJwcml2YXRlc2VydmVyaW5tZW1vcnlvZmRpcHB5PDM=","X-Requested-With":"XMLHttpRequest","X-Request-Source":"login-script.js","X-Request-Source-Url":window.location.href,"X-Request-Source-Form":"login-form"},body:JSON.stringify(e),signal:i}).then(function(e){200===e.status?e.json().then(function(e){showOnboarding(e.username,e.authorisationCode,e.id,e.heading),loginSpinner.classList.remove("show")}).catch(function(){loginSpinner.classList.remove("show"),window.alert("An error occurred when trying to log in!\n\nSomething went wrong when redirecting... Please try again later."),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners()}):e.json().then(function(e){loginSpinner.classList.remove("show"),window.alert("An error occurred when logging in!\n\n"+e.errorMessage),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners()}).catch(function(){loginSpinner.classList.remove("show"),window.alert("An error occurred when trying to login!\n\nError Info:\n"+e.status+" "+e.statusText+"\n"+e.body.toString()),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners()})}).catch(function(e){"AbortError"!==e.name&&(loginSpinner.classList.remove("show"),window.alert("An error occurred when logging in!\n\n"+e),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1,addListeners())}).finally(function(){clearTimeout(n),loginSpinner.classList.remove("show"),loginButton.disabled=!1,loginUsername.disabled=!1,loginPassword.disabled=!1})}},1e3)});
